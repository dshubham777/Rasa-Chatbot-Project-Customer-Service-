(this["webpackJsonprasa-frontend"]=this["webpackJsonprasa-frontend"]||[]).push([[6],{1600:function(e,r,t){"use strict";t.r(r);var n=t(0),l=t(20),a=t(2),o=t(207),s=t(140),u=t(57),c=t(66),i=t(1),f=t(23),d=t(100),m=t(43),h=t(3),v=t(9),w=t(30),y=t(65),E=t(266),R=t(139);function b(e){var r=e.onDelete,t=e.onLoadMoreRows,l=e.onSaveUserRoles,a=e.onSearch,o=e.roles,s=e.searchQuery,u=e.total,c=e.roleTotals,f=e.unfilteredTotal,d=e.userRoles,b=e.users,p=n.useCallback((function(e,r){return n.createElement(E.a,{p:4,name:"Roles",items:o.map((function(e){return e.role})),checkedItems:e.filter((function(e){return"role"===e.keyword})).map((function(e){return e.value})),onChange:function(t){return r(e.filter((function(e){return"role"!==e.keyword})).concat(t.map((function(e){return{keyword:"role",value:e,negated:!1}}))))}})}),[o]),k=n.useMemo((function(){return{keyword:"role",values:o.map((function(e){return{label:e.role,total:c[e.role]||0}})),clear:!0,all:"All",total:f}}),[o,c,f]),x=n.useCallback((function(e){var r=e.selected,t=e.onChangeSelected;return function(e){var l=e.rowIndex,a=e.rowData;if(!a)return null;var o=r.includes(l);return n.createElement(i.Flex,{alignItems:"center"},n.createElement(i.Box,{flex:"0 1 auto",mr:3},n.createElement("label",null,n.createElement(y.a,{checked:o,onChange:function(){return t(l,!o)}}))),n.createElement(i.Box,{flex:"1",style:{overflow:"hidden",textOverflow:"ellipsis"}},n.createElement(h.f,{variant:"bodySecondary"},a.username)))}}),[]),D=function(e){var r=e.rowData;if(!r)return null;var t=o.map((function(e){return{label:e.role,value:e.role,data:e}})),a=(d[r.username]||[]).map((function(e){return{label:e.role,value:e.role,data:e}}));return n.createElement(h.e,{isMulti:!0,placeholder:"Unassigned",options:t,onChange:function(e){return Array.isArray(e)&&l({user:r,roles:e.map((function(e){return e.data}))})},value:a})},T=function(e){var t=e.rowData;return t?n.createElement(i.Flex,{flexDirection:"row-reverse",mr:-1},n.createElement(w.a,{resource:v.c.Users,action:v.a.Delete,yes:n.createElement(h.a,{mr:1,variant:"icon",onClick:function(){r([t])}},n.createElement(h.c,{icon:"trash-alt"}))})):null};return n.createElement(R.a,{bulkActionsRenderer:function(e){var t=e.dataSelected,l=e.setSelected;return n.createElement(w.a,{resource:v.c.Users,action:v.a.Delete,yes:n.createElement(h.a,{onClick:function(){r(t),l([])},variant:"inverse"},"Delete")})},data:b,filtersRenderer:p,quickFilters:k,onLoadMoreRows:t,onSearch:a,resource:v.c.User,searchQuery:s,total:u},(function(e){return[n.createElement(m.d,{key:"model",cellDataGetter:function(){},flexGrow:2,width:300,dataKey:"username",label:"User",className:"ReactVirtualized__Table__rowColumn_overflow",cellRenderer:x(e)}),n.createElement(m.d,{key:"type",cellDataGetter:function(){},flexGrow:3,width:450,dataKey:"roles",label:"Roles",cellRenderer:D}),n.createElement(m.d,{key:"actions",cellDataGetter:function(){},flexGrow:1,width:150,dataKey:"username",className:"ReactVirtualized__Table__rowColumnOnHover",label:"",cellRenderer:T})]}))}function p(e){var r=e.onDelete,t=e.onFetchRoles,l=e.onFetchUsers,a=e.onLoadMoreRows,o=e.onSaveUserRoles,s=e.roles,u=e.roleTotals,c=e.searchQuery,m=e.total,h=e.userRoles,v=e.users,w=e.unfilteredTotal,y=Object(f.g)();n.useEffect((function(){y("view:users:loaded")}),[y]),n.useEffect((function(){l({search:c,offset:0,limit:20}),t({search:"",offset:0,limit:0})}),[t,l,c]);var E=n.useCallback((function(e){return l({search:e,offset:0,limit:20})}),[l]),R=Object.values(s);return n.createElement(d.a,{title:"Users"},n.createElement(i.Flex,{flexDirection:"column",style:{height:"100%"}},n.createElement(i.Box,{flex:"1"},n.createElement(b,{roles:R,userRoles:h,total:m,roleTotals:u,users:v,unfilteredTotal:w,onDelete:r,onLoadMoreRows:a,onSearch:E,searchQuery:c,onSaveUserRoles:o}))))}var k={onFetchUsers:u.d.request,onDelete:u.a.request,onFetchRoles:c.d.request,onSaveUserRoles:u.f.request};r.default=Object(l.b)((function(e){return{users:e.users.users,total:e.users.total,roleTotals:e.users.roleTotals,searchQuery:e.users.searchQuery,userRole:e.auth.role,userRoles:e.users.userRoles,roles:e.roles.roles,unfilteredTotal:e.users.unfilteredTotal}}),k)((function(e){return n.createElement(o.a,{listener:s.b,start:Object(a.getType)(u.d.request),resolve:Object(a.getType)(u.d.success),reject:Object(a.getType)(u.d.failure)},(function(r){return n.createElement(p,Object.assign({},e,{onLoadMoreRows:r}))}))}))}}]);